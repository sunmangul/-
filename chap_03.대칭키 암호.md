# <p align="center">🔐대칭키 암호</p>
## 🔒 현대 대칭키 암호
### ✅  현대 블록 암호
#### 1) 현대 블록 암호의 구성요소
- 개요
  - 확산과 혼돈같은 성질을 위해 전치요소와 치환요소 그 밖의 구성 요소 결합(합성 암호)
  - 이동요소, 교환요소, 분할요소, 조합요소에 더해 전치 장치, 치환 장치, XOR연산의 조합
  - 대칭키 암호에 의한 암호화는 평문을 추측할 수 없게 해야함

▶ 혼돈과 확산
- 혼돈 : 암호문과 키의 상관관계를 숨김
- 확산 : 평문의 통계적 성질을 암호문 전반에 퍼뜨려 숨김
#### 2) 전치요소 (P-box)
- 문자 단위로 암호화를 소행하였던 고전 전치 암호를 병렬적으로 수행
- 단순 P-box, 확장 P-box, 축소 P-box 세 가지 종류가 있음
  - 축소 P-box
    - n비트를 입력받아 m비트를 출력 (n>m)
    - 입력 비트 중 특정 비트는 소실되어 출력되지 않음
    - 비트를 치환하고 다음 단계에서 비트의 수를 줄이고자 할 때 사용
  - 확장 P-box
    - n비트를 입력받아 m비트를 출력 (n<m)
    - 입력 비트 중 특정비트는 한 개 이상의 출력비트와 연결
    - 비티를 치환하고 다음 단계에서 비트의 양을 증가시키자고 할 때 사용
  - 역함수의 존재성
    - 단순 P-box는 역함수가 존재
    - 축소 P-box와 확대 P-box는 역함수고 존재하지 않음

#### 3) 치환요소 (S-box)
- 치환 암호와는 다르게 n비트와 m비트가 달라도 상관없음
- 입력값과 출력값 사이의 관계가 테이블 혹은 수학적 관계로 정의
- 역함수가 존재할 수도, 존재하지 않을 수도 있다.
- 역함수가 존재하면 입력 비트와 출력 비트의 개수가 동일하다

#### 4) 합성 암호
- 개요
  - 치환, 전치 그리고 그 밖의 구성요소를 결합한 복잡한 암호
- 확산과 혼돈
  - 확산
    - 암호문과 평문 사이의 관계를 숨김
    - 암호문에 대한 통계 테스트를 통해 평문을 찾고자 하는 공격자를 좌절시킴
  - 혼돈
    - 암호문과 키의 관계를 숨김
    - 암호문을 이용하여 키를 찾고자 하는 공격자를 좌절시킴
    - 키의 단일 비트가 면하면 암호문의 거의 모든 비트가 변경됨
- 라운드
  - 반복적으로 사용되는 합성 암호

▶ 양자 암호학 : 불확정성 원리를 응용한 암호화 방식<br/>
단단한 상자를 만들어 내용물을 보관하는 것이 아니라 열어보면 내용을 폐기하는 매우 약한 상자를 이용

#### 5) Feistel 암호
- 개요
  - 페이스텔 구조에서 네트워크라는 이름은 구성도가 그물 짜는 형식으로 교환됨
  - 평문 블록의 길이와 키 K의 길이, 라운드 수가 암호 강도를 결정
  - 평문은 64(최근 128)bit 이상, 키 K의 길이는 64(최근 128)bit 내외, 라운드 수는 16(최소 3)회 이상 권장
    - 블록과 키의 길이, 라운드 수가 크고 많을수록 보안은 강하지만 암복호화 속도가 떨어짐
    - 서브키 생성 알고리즘이 복잡할수록 암호해독이 어려움
    - 라운드 함수가 복잡할 수록 암호해독이 어려움
  - 암호화와 복호화 과정이 동일
    - 복호화 과정에서 암호문과 보조키 K_{i} 입력
    - 보조키 K_{i}의 입력 순서는 암호화 과정의 입력 순서와 반대
  - 구조상에 문제점이 발견되지 않음
  - 라운드 함수와 상관없이 역변환 가능
  - 완전한 확산과 알고리즘의 수행속도가 빠르고 소프트웨어구현이 용이
- Feistel 특징
  - 입력 n비트를 블록 두 개로 나누어 라운드 함수를 F, 라운드키를 K_{i}라 표현
  - i번째 라운드의 과정
    - L_{i} = R_{i-1}
    - R_{i} = L_{i-1}⊕F_{i}(R_{i},K_{i})
  - 페이스텔 네트워크는 많은 블록 암호 알고리즘에서 이용
    - ex) AES최종 후보중 3개(MARS, RC6, Twofish)에 사용(최종 AES로 선정된 Rijndael은 사용 안함)

#### 6) SPN 구조
- 구조
  - 블록 암호는 라운드 함수를 반복적으로 적용하는 방법에 따라 크게 두 가지 형태로 구별
    - SPN
      - 여러 개의 함수를 중첩하면 개별 함수로 이루어진 암호보다 안전하다는 이론에 근거
      - 고전암호인 Substitution Cipher와 Permutation Cipher를 중첩하는 형태로 개발
    - Feistel
- 암호화
  - 입력을 여러 개의 소블록으로 나눔
  - 각 소블록을 S-box로 입력하여 대치
  - S-box의 출력을 P-box로 전치
  - 반복

### ✅ 블록 암호에 대한 공격
#### 1) 차분 분석
- 선택 평문공격법
- 두개의 평문 블록들의 비트의 차이에 대하여 대응되는 암호문 블록들의 비트차이를 이용
- 블록 암호는 평문이 한 비트라도 달라지면 암호문은 전혀 다른 비트 패턴이 됨을 알 수 있음
- 암호문의 변화 형태를 조사하여 해독

#### 2) 선형 분석
- 기지평문 공격의 한 종류
- 비선형 구조를 적당히 선형화시켜 키를 찾는 방법
- 암호화 과정에서의 근사적 선형 관계식을 찾는 것을 목적으로 함
- 찾았다면 기지평문 공격에서 Chosen Plaintext 공격 수행 가능

#### 3) 전수공격법
- 암호화에 일어날 수 있는 가능한 모든 경우에 대하여 조사하는 방법
- 경우의 수가 많은 경우에는 실현 불가능한 방법

#### 4) 통계적 분석
- 암호문에 대한 평문의 각 단어별 빈도에 관한 자료를 이용
- 지금까지 알려진 모든 통계적인 자료를 더불어 이용하여 해독하는 방법

#### 5) 수학적 분석
- 통계적인 방법을 포함하며 수학적 이론을 이용하여 해독하는 방법

### ✅ 현대 스트림 암호
#### 1) 개요
- 기본 개념
  - 암호화와 복호화는 한 번에 r비트를 생성
  - 키 비트 스트림을 각각 P=p_{n} ⋯p_{2}p_{1}, C=c_{n} ⋯c_{2}c_{1}, K=k_{n} ⋯k_{2}k_{1}
  - p_{i}, c_{i}, k_{i}는 r비트워드
  - 암호화는 c_{i} = E(k_{i}, p_{i}) 이고 복호화는 p_{i} = D(k_{i}, c_{i})
  - 동기식과 비동기식 두 가지 종류로 분류
- 고려사항

      1. 암호화의 연속은 긴 주기를 가져야 함
      - 의사 난수 생성기는 언젠가는 반복되는 비트 스트림을 생산하기 때문에 반복주기를 길게 함
      - 반복 주기가 길다는 것은 암호를 해독하는것이 그만큼 어려움을 의미
      2. 키 스트림은 진 난수 스트림과 최대한 비슷해야함
      - 1과 0의 개수가 거의 동일해야 한다는 등 비슷한 부분을 가져야 함
      - 키 스트림이 바이트의 스트림으로 처리 됐다면, 모든 가능한 값은 대략 거의 같은 빈도로 나타남
      - 키 스트림이 랜덤하게 나타날수록 암호문은 더 랜덤화 됨
      3. 전사적 공격에 대응하기 위해서는 키가 충분히 길어야 함
      - 현재 기술 수준을 볼 때 키 길이가 적어도 128비트인 것이 바람직함
#### 2) 동기식 스트림 암호
- 개요
  - 키 스트림과 암호문 사이에 동기가 필요한 동기식 스트림 암호
  - 키 스트림이 평문과 관계없이 생성
    - 암호문에 들어있는 키 스트림과 암호문으 독립성으로 인가자 이외에는 정보 유출의 가능성 적음
- One-Time Pad
  - 개요
    - 동기식 스트림 암호 중에서 가장 안전한 암호
    - 암화를 수행할 때마다 랜덤하게 선택된 키 스트림 사용
    - 샤논에 의해 해독 불가능하다는 것이  수학적으로 증명(무조건 안전) 
  - 암복호화
    - 암호화와 복호화에 배타적 논리합 연산을 사용
    - 암호화 알고리즘과 복호화 알고리즘은 역관계
    - 배타적 논리합 연산을 한 번에 한 비트씩 적용

▶ **패드는 한번만, 메세지 길이만큼, 목적지로 안전하게 배포되고 보호, 순수한 임의값으로 제작**

- 귀환 시프트 레지스터(FSR)
  - 개요
    - One-Iime Pad의 절충안(FSR)
    - 소프트웨어와 하드웨어 환경에서 모두 구현될 수 있지만 하드웨어 구현이 용이

- 선형 귀환 시프트 레지스터(LFSR)
  - 개요
    - 하드웨어로 쉽게 구현
    - 모든 스트림 암호는 아니지만 많은 스트림 암호가 채택하는 방법
    - 최대 주기는 2^m-1
  
- 비선형 귀환 시프트 레지스터(NLFSR)
  - 개요
    - LFSR운 선형성 때문에 공격에 취약해서 NLFSR을 이용하여 보다 안전한 암호 설계
  
#### 3) 비동기식 스트림 암호(자기 동기식)
- 개요
  - 키 스트림이 평문 또는 암호문과 관계를 같는 암호 시스템
  - 평문 혹은 암호문으로부터 함수 관계에 의해 키 스트림이 생성(키가 평문이나 암호문에 종속적)
  - 암호문의 비트가 손신 또는 변경되어도 오류 전파가 유한함
  - 오류 정정의 기능을 포함할 수 있다는 장점을 가지고 있지만 해독되기 쉽다는 단점
- 여담
  - 블록 암호에서 다른 운영 모드를 생성하기 위해 CFB모드를 사용해 실제로 스트림 암호를 생성

#### 4) 강력한 스트림 암호 특징
- 키스트림 값 내부에서 장기간 동안 반복되는 패턴이 없음
- 통계적으로 예측 가능하지 않은 키스트림
- 키스트림은 키와 선형적인 관계에 있지 않음 -> 키스트림값을 알았다는게 키값을 안다는 것과 별개
- 통계적으로 치우치지 않은 키스트림(0과 1의 개수 비율)
  
## 📈 DES(Data Encryption Standard)
### ☑ 개요
#### 1) 역사
- 미국 국립기술표준원(NIST)가 1973년 국가적으로 사용할 대칭키 암호 시스템의 제안 요청서 발표
- 이후 Lucifer 프로젝트의 수정판인 IBM의 제안이 DES로 채택
- DES는 1975년 3월에 연방관보에서 연방정보처리기준(FIPS)의 초안으로 공표(FIPS PUB 46)
- DES는 발표 이후 가장 널리 사용되는 대칭키 블록 암호가 됨
- DES를 3번 반복하는 3중 DES의 사용을 권고하는 새로운 표준 FIPS46-3 발표
- 최신 블록암호 표준인 AES는 DES를 대체하기 위해 표준으로 재정된 알고리즘
#### 2) 개관
- 평문과 암호문의 길이는 64비트 블록 단위, 키의 길이는 56비트(+8비트의 패리티 비트), 라운드 16회
- 원래 키로부터 16개의 서브키를 생성하고 각 라운드에서 사용
- 키는 7비트마다 오류검출을 위한 정보를 1비트씩 삽입 
- Feistel 네트워크의 변형된 형태를 가짐
- DES의 복호화는 근본적으로 암호화과정과 동일(서브키 순서만 뒤집음)

### ✅ DES의 구조
#### 1) 개요
- 암호화 과정은 두 개의 P-box와 17개의 Feistal 라운드 함수로 구성
- P-box 중 하나는 초기 전치(initial permutation), 다른 하나는 최종 전치(final permutation)라 함
- 라운드 키 생성기에 의해 암호키로부터 생성된 48비트 라운드 키를 사용
#### 2) 라운드 함수
- 개요
  - 16번의 라운드 함수는 각 Feistel 암호로 되어 있음
  - 라운드 함수의 경우는 이전 라운드 함수나 초기 전치박스의 출력값을 입력
  - 입력 된 값은 다음 라운드나 최종 전치 박스에 입력으로 전송 될 값을 생성<br/>
  ※ 위에서 출력값은 L_{i-1}와 R_{i-1}, 입력값은 L_{i}와 R_{i}
  - 각 라운드에는 환합기와 교환기라는 2개의 암호요소가 존재
  - 암호 요소들은 역연산이 가능(교환기는 역연상이 명백히 가능)
  - 최종전치는 서로 역의 관계에 있는 P-box라 DES에 있어서 암호학적으로 중요하지 않음
- DES 함수
  - DES의 핵심인 함수
  - 라운드 함수에 사용된 ⨍(R_{i-q},K_{i})를 가르킴
  - 32비트 출력값을 산출하기 위하여 가장 오른쪽의 32비트(R_{i-1})에 48비트 키를 적용
  - 확장 P-box, 키 XOR, 8개의 S-box, 4개의 단순 P-box로 구성
#### 3) 암호화와 복호화 알고리즘
- 개요
  - 혼합기와 교환기를 사용하여 16라운드 암호화 알고리즘과 복호화 알고리즘을 만듦
  - 암호화와 복호화의 라운드 키는 역순으로 적용
- 키 생성
  - 라운드 키는 56비트 암호키로부터 16개의 48비트 라운드 키를 생성
  - 암호화 키는 64비트로 주어지는데 이중 8비트는 패리티 비트로 실제 키 생성 과정 전에 제거

### ✅ DES 분석
#### 1) 설계 기준
- S-box
  - S-box는 각 라운드에서부터 그 다음 라운드까지 혼돈을 만족하도록 설계
  - S-box는 비선형 함수
  - 입력값의 한 비트를 바꾸면, 출력값에서는 두 비트 이상 변경
- P-box
  - 2개의 P-box로 비트를 동시에 확산 시킴
    - 32비트 -> 32비트 단순 P-box
    - 32비트 -> 48비트 확장 P-box
#### 2) DES의 취약점
- 평문 또는 키의 작은 변화가 암호문에 큰 변화를 만드는 쇄도효과가 매우 큼
- 암호문의 비트가 평문의 비트에 의존하는 완비성이 높아 암호문으로부터 평문 추론이 어려움
- 56비트 키를 사용하여 최대 키 공간의 크기는 2^56으로 개발 당시에는 전사 공격에 안전한 키 길이였으나 계산 능력 발전으로 더 이상 전사 공격에 위험
  - 1998년에 3일 만에 전사 공격에 의해 해독 된 사례가 있음

### ✅ 다중 DES
#### 1) 3중 DES(Triple DES)
- 개요
  - 보편적으로 사용되는 두 가지 3중 DES
    - 두 개의 키를 갖는 3중 DES
    - 새 개의 키를 갖는 3중 DES
- 3중 DES 현황
  - 처리 속도가 빠르지 않아 과거에 DES로 암호화했던 자료의 호환성을 생각하는 경우가 아니면 사용하는 경우가 적음
  - 우리나라에서는 표준으로 정하여 사용하지 않음
    - TTA에서 블록 암호 SEED를 국가 표준으로 정함
    - ARIA는 학계, 정부기관으로 구성된 학연관 공동으로 개발
  
▶ 대칭키 암호 기법은 DES가 3DES에 비해 2.5배 빠르고, AES-1289은 DES보다 3배 정도 빠름<br/>
▶ 스트림 암호화 기법인 RC4는 AES-128보다 2배 빠름

- 두 개의 키를 갖는 3중 DES
  - 첫 번째와 세 번째 단계에서는 k_{1}, 두 번째 단계에는 k_{2}를 사용
  - 하나의 DES로 3중 DES를 만들기 위해 암호화 중간 단계에서 복호화 알고리즘을 사용
  - 하나의 DES로 3중 DES를 만들기 위해 복호화 중간 단계에서 암호화 알고리즘 사용
- 세 개의 키를 갖는 3중 DES
  - 두 개의 키를 갖는 3중 DES는 기지평문공격 가능성 때문에 세 개의 키를 갖는 3중 DES 사용
  - PGP와 같은 응용 프로그램에서 사용
  - 암호화와 복호화는 서로 역순으로 진행
- DES와의 호환성
  - 3중 DES에서 모든 키를 동일하게 하면 보통의 DES와 같아짐
    - 최초의 암호화 -> 복호화로 평문으로 돌아가기 때문
    - 과거에 DES로 암호화된 암호문은 3DES를 사용하여 복호화할 수 있음

구분 | DES | Triple DES | AES
:---: | :---: | :---: | :---:
평문 블록 크기(bits) | 64 | 64 | 128
암호문 블록 크기(bits) | 64 | 64 | 128
키 크기(bits) | 56 | 112 or 168 | 128 or 192 or 256

## 📊 AES(Advanced Encryption Standard)
### ☑ 개요
#### 1) 역사
- DES를 대체하기 위해 1997년에 공모
- 1차에서 15개, 2차에서 5개(MARS, RC6, Rijindael, Serpent, Twofish)
- NIST가 2001년 11월 레인달(Rijndael)을 AES알고리즘으로 최종 선택

      ※ 응모 조건
      - 알고리즘이 기밀이 아니어야함(공개적 발표)
      - 키 사이즈: 128/192/256bit 중 선택 가능
      - 국제적으로 자유로운 사용이 가능할 것
      - 3중 DES보다 효율적이고 안전한 알고리즘일 것
#### 2) 선정 기준
- 안전성, 비용, 구현 효율성

#### 3) 라운드
- 평문 128비트를 암호문 128비트로 출력(non-Feistel 알고리즘에 속함)
- 10,  12, 14라운드를 사용, 라운드에 대응하는 키는 128, 192, 256비트
- 키 크기에 따라 AES-128, AES-192, AES-256으로 불림
- 키 확장 알고리즘으로부터 생기는 라운드 키 크기는 평문과 암호문과 동일한 128비트

### ✅ 암호
#### 1) 개요
- DES는 Feistel network를 기본 구조로 사용하지만, Rijndael는 SPN구조 사용
- 각 라운드는 비 선형성을 갖는 S-box를 적용하여 바이트 단위로 치환을 수행하는 SubBytes( ) 연산, 행 단위로 순환 시프트를 수행하는 ShiftRows( ) 연한, 높은 확산을 제공하기 위해 열 단위로 혼합하는 MixColumns( ) 연산과 라운드 키와 state를 EX-OR하는 AddRoundKey( )연산으로 구성
- 마지막 라운드에서만 MixColumns( ) 연산을 수행하지 않음
- 블록 알고리즘에 의한 모든 공격 방법으로부터 안전하게 설계
- 하드웨어나 소프트웨어 구현 시 속도나 코드 압출성 면에서 효율적

▶ - SubBytes 연산은 16개의 독립된 바이트 단위의 변환을 수행<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- SubBytes 변환과와 InSubBytes 변환은 서로 역변환 관계를 가짐<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- MixColumns와 InMixColumns는 서로 열변환 관계를 가짐

▶ SPN 구조<br/>&nbsp;&nbsp;- SPN 구조는 라운드 함수가 역변환되여야 한다는 제약이 있음<br/>&nbsp;&nbsp;- 더 많은 병렬성을 제공하여 암복호화 알고리즘에 고속화를 요구<br/>&nbsp;&nbsp;- CPU가 더 많은 병렬성을 요구하는 추세에 부응하는 방식<br/>&nbsp;&nbsp;- 입력을 소블록 여러개로 나누고 소블록을 S-box에 입력, 치환 후 S-box의 출력을 P-box로 전치하는 과정 반복

▶ Feistel과 SPN구조 알고리즘
<br/>&nbsp;&nbsp;- Feistel : DES, LOKI, CAST, Blowfish, MISTY, RC5, RC6, CAST256, E2, Twofish, Msrs
<br/>&nbsp;&nbsp;- SPN : SAFER, SHARK, Square, CRYPTION, Rijndael, SAFER+, Serpent, PRESENT

▶ 키의 길이가 여러비트로 크기가 달라질 수 있지만 라운드 키는 모두 128비트이다.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Feistel
## 📝기타 대칭키 암호 알고리즘
### ✅ 국제 암호 알고리즘
#### 1) IDEA(International Data Encryption Algorithm)
- DES를 대체하기 위해 스위스 기관에서 개발한 알고리즘
- 128비트 키, 64비트 블록 암호(Feistel의 주고 변형)
- Feistel과 SPN의 중간 형태인 Lai-Massey Scheme